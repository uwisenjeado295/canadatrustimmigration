<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Practice TCF-CANADA ‚Äì Speaking (Expression orale)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<meta name="description" content="Pr√©parez l'expression orale du TCF Canada : structure, bar√®me, conseils, et banques compl√®tes de sujets avec r√©ponses mod√®les (T√¢ches 1, 2, 3)." />
<style>
  :root{--ink:#1f2937;--muted:#6b7280;--line:#e5e7eb;--bg:#f8fafc;--card:#ffffff;--blue:#0033a0;--pill:#eef2ff}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Arial;color:var(--ink);background:var(--bg)}
  header{position:sticky;top:0;z-index:10;background:#fff;border-bottom:1px solid var(--line)}
  .wrap{max-width:980px;margin:0 auto;padding:1rem}
  h1{font-size:1.45rem;margin:.2rem 0}
  .lead{color:var(--muted);margin-top:.2rem}
  .pill{display:inline-block;padding:.18rem .55rem;border-radius:999px;background:var(--pill);font-weight:600;font-size:.85rem}

  .grid{display:grid;gap:1rem}
  @media(min-width:840px){.grid.cols-3{grid-template-columns:1.1fr 1fr 1fr}}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.04);padding:1rem}
  h2{font-size:1.15rem;margin:.2rem 0 .6rem}
  h3{font-size:1rem;margin:.7rem 0 .4rem}
  .meta{color:var(--muted);font-size:.92rem}
  .tip{background:#f0fdf4;border:1px solid #dcfce7;padding:.6rem .75rem;border-radius:10px}

  .tabs{display:flex;gap:.5rem;flex-wrap:wrap;margin:.25rem 0 .75rem}
  .tab{padding:.45rem .85rem;border:1px solid var(--line);border-radius:999px;background:#fff;font-weight:700;cursor:pointer}
  .tab.active{background:var(--blue);color:#fff;border-color:var(--blue)}

  .item{border:1px solid var(--line);border-radius:12px;margin:.7rem 0;overflow:hidden;background:#fff}
  .item header{display:flex;justify-content:space-between;align-items:center;padding:.8rem 1rem;border-bottom:1px solid var(--line)}
  .item h4{margin:0;font-size:1rem;font-weight:700}
  .item .q{padding:1rem;padding-bottom:.25rem}
  .item .a{padding:0 1rem 1rem 1rem;color:#111}
  .muted{color:var(--muted)}
  .badge{display:inline-block;padding:.12rem .45rem;border-radius:6px;background:#eff6ff;border:1px solid #dbeafe;font-weight:700;font-size:.8rem;margin-left:.4rem}
  .controls{display:flex;gap:.5rem;align-items:center}
  .btn{padding:.52rem .9rem;border-radius:8px;border:1px solid var(--line);background:#fff;font-weight:700;cursor:pointer}

  .search{display:flex;gap:.5rem;align-items:center;border:1px solid var(--line);padding:.45rem .6rem;border-radius:10px;background:#fff}
  .search input{border:none;outline:none;width:100%}
  footer{color:var(--muted);text-align:center;padding:2rem 1rem}
  details summary{cursor:pointer;list-style:none}
  details[open] summary .arrow{transform:rotate(90deg)}
  .arrow{display:inline-block;transition:.15s}
  .list{display:grid;gap:.75rem}
  .hl{font-weight:700}

  /* Paragraph & list formatting inside answers */
  .item .a p{margin:.5rem 0 0 0}
  .item .a ul{margin:.5rem 0 0 1.2rem}
  .item .a li{margin:.25rem 0}
  .label{font-weight:700}

  /* Auth helpers */
  .hidden{display:none}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <h1>Practice TCF-CANADA ‚Äì Speaking <span class="pill">Expression orale</span></h1>
    <div class="lead">Structure, bar√®me, conseils pratiques et banques de sujets avec r√©ponses mod√®les (T√¢ches 1, 2, 3).</div>
  </div>
</header>

<div class="wrap">
  <!-- LOGIN (same credentials as Listening/Reading) -->
  <section id="loginCard" class="card">
    <h2>üîí Acc√®s r√©serv√©</h2>
    <p>Entrez <b>Nom</b>, <b>Email</b>, <b>Nom d‚Äôutilisateur</b> et le <b>Mot-cl√©</b> fournis par l‚Äôadministrateur.</p>
    <form id="loginForm">
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:.8rem">
        <label>Nom complet <input name="name" required></label>
        <label>Email <input name="email" type="email" required></label>
        <label>Nom d‚Äôutilisateur <input name="username" required></label>
        <label>Mot-cl√© <input name="keyword" required></label>
      </div>
      <input type="hidden" name="fn" value="login">
      <div class="controls" style="margin-top:.75rem">
        <button class="btn" type="submit">Se connecter</button>
        <span id="loginMsg" style="color:#b00020;font-weight:700;display:none;margin-left:.5rem"></span>
      </div>
    </form>
  </section>
</div>

<!-- APP (hidden until auth OK) -->
<main id="app" class="wrap hidden">

  <!-- OVERVIEW -->
  <section class="grid cols-3">
    <article class="card">
      <h2>Structure de l‚Äôexamen</h2>
      <ul class="list meta">
        <li><span class="hl">T√¢che 1 ‚Äì Donner une opinion / pr√©sentation</span> (~2 min)</li>
        <li><span class="hl">T√¢che 2 ‚Äì Interaction simul√©e</span> (~2 min)</li>
        <li><span class="hl">T√¢che 3 ‚Äì Demander / donner des informations</span> (~2 min)</li>
      </ul>
      <p class="meta" style="margin-top:.5rem">R√©ponses enregistr√©es; pas de temps de pr√©paration; les t√¢ches s‚Äôencha√Ænent.</p>
    </article>

    <article class="card">
      <h2>Bar√®me & attentes</h2>
      <p class="meta">√âvaluation A1 ‚Üí C2 : lexique, grammaire, coh√©rence, fluidit√©, prononciation et pertinence. Les r√©ponses C1/C2 utilisent des connecteurs vari√©s et une argumentation claire.</p>
    </article>

    <article class="card">
      <h2>Conseils</h2>
      <div class="tip meta">
        ‚Ä¢ Structurez: Intro ‚Üí 2‚Äì3 id√©es + exemples ‚Üí nuance ‚Üí conclusion. ‚Ä¢ Variez les connecteurs (cependant, en revanche, par ailleurs‚Ä¶). ‚Ä¢ Donnez des exemples concrets. ‚Ä¢ Parlez sans traduire mentalement.
      </div>
    </article>
  </section>

  <!-- FILTERS / TABS -->
  <section class="card">
    <div class="controls" style="justify-content:space-between;flex-wrap:wrap;gap:.75rem">
      <div class="tabs" id="tabs">
        <button class="tab active" data-task="1">T√¢che 1</button>
        <button class="tab" data-task="2">T√¢che 2</button>
        <button class="tab" data-task="3">T√¢che 3</button>
      </div>
      <label class="search">
        <span class="muted">üîé</span>
        <input id="q" type="search" placeholder="Rechercher un sujet‚Ä¶ (ex : r√©seaux sociaux, t√©l√©travail)">
      </label>
    </div>
    <div id="list"></div>
  </section>

  <!-- HOW TO ANSWER -->
  <section class="card">
    <h2>Gabarits rapides</h2>
    <details open>
      <summary><span class="arrow">‚ñ∂</span> T√¢che 1 ‚Äì Opinion / Pr√©sentation</summary>
      <ul class="list meta">
        <li><b>Intro</b> : reformulez le sujet / pr√©sentez-vous + position.</li>
        <li><b>2‚Äì3 arguments</b> + exemple concret chacun.</li>
        <li><b>Nuance</b> / contre-argument bref.</li>
        <li><b>Conclusion</b> : r√©ponse claire + ouverture.</li>
      </ul>
    </details>
    <details>
      <summary><span class="arrow">‚ñ∂</span> T√¢che 2 ‚Äì Interaction</summary>
      <ul class="list meta">
        <li><b>Contexte</b> (bonjour + motif) ‚Üí <b>demande claire</b>.</li>
        <li><b>Infos</b> : r√©f√©rences, dates, pi√®ces.</li>
        <li><b>Politesse</b> : formule / solution propos√©e.</li>
      </ul>
    </details>
    <details>
      <summary><span class="arrow">‚ñ∂</span> T√¢che 3 ‚Äì Infos</summary>
      <ul class="list meta">
        <li><b>But</b> ‚Üí <b>questions pr√©cises</b> (prix, d√©lais, documents‚Ä¶).</li>
        <li><b>Relance</b> : options / alternatives.</li>
        <li><b>Cl√¥ture</b> polie.</li>
      </ul>
    </details>
  </section>
</main>

<footer>
  <div>¬© <span id="year"></span> Canada Trust Immigration ‚Äî Page d‚Äôentra√Ænement non officielle (usage p√©dagogique).</div>
</footer>

<script>
/* ===================== AUTH (reuse your Listening API) ===================== */
// Use the same Apps Script endpoint as your Listening page.
// You can override by adding ?api=... in the URL.
const API = new URLSearchParams(location.search).get('api')
  || 'https://script.google.com/macros/s/AKfycbxT33id0jIMalSgDeZVsLs3Mc8GTuK2ckmNckhINsjBlzzEd5qZpoTzkNX1eallBDIreA/exec';

function api(q){ return API + (API.includes('?') ? '&' : '?') + q; }

let SESSION = { token:null, username:null, name:null, email:null };
function saveSession(){ sessionStorage.setItem('tcf_session', JSON.stringify(SESSION)); }
function loadSession(){ try{ const s=sessionStorage.getItem('tcf_session'); if(s) SESSION=JSON.parse(s);}catch{} }

async function checkSession(){
  loadSession();
  if(!SESSION.token) return false;
  try{
    const r = await fetch(api(`fn=check&token=${encodeURIComponent(SESSION.token)}`));
    const j = await r.json();
    return !!j.ok;
  }catch{ return false; }
}
function showApp(){ document.getElementById('loginCard')?.classList.add('hidden'); document.getElementById('app')?.classList.remove('hidden'); }
function showLogin(msg){
  if(msg){ const el = document.getElementById('loginMsg'); el.textContent = msg; el.style.display='inline'; }
  document.getElementById('app')?.classList.add('hidden');
  document.getElementById('loginCard')?.classList.remove('hidden');
}

// Auto-resume
(async ()=>{ if(await checkSession()) showApp(); else showLogin(''); })();

// Handle login submit
document.getElementById('loginForm')?.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  fd.append('userAgent', navigator.userAgent);
  const msg = document.getElementById('loginMsg'); msg.style.display='none';
  try{
    const res = await fetch(API, { method:'POST', body: fd }).then(r=>r.json());
    if(!res.ok){ msg.textContent = res.error || '√âchec de connexion'; msg.style.display='inline'; return; }
    SESSION = { token:res.token, username:res.username, name:res.name, email:res.email };
    saveSession(); showApp();
  }catch{ msg.textContent='Erreur r√©seau'; msg.style.display='inline'; }
});
</script>

<script>
/* ===================== RENDER HELPERS ===================== */
function formatAnswer(raw){
  if(!raw) return "";
  let txt = String(raw).trim().replace(/\r/g,"");

  // Bold common section labels at line starts
  const labels = ["Introduction","Arguments","Argument","D√©veloppement","Contre-argument","Contre argument","Objection","Conclusion","Ouverture"];
  labels.forEach(l=>{
    const re = new RegExp(`(^|\\n)\\s*${l}\\s*:?\\s*`,"gi");
    txt = txt.replace(re,(m,g1)=> `${g1}<span class="label">${l} :</span> `);
  });

  // Split to paragraphs; bullet lines beginning with - / ‚Ä¢ into <ul>
  const lines = txt.split(/\n/);
  const blocks = [];
  let bullets = [];
  const flushBullets=()=>{ if(bullets.length){ blocks.push("<ul>"+bullets.map(b=>`<li>${b}</li>`).join("")+"</ul>"); bullets=[]; } };

  for(const line of lines){
    const s = line.trim();
    if(!s){ flushBullets(); blocks.push(""); continue; }
    if(/^[-‚Ä¢]\s+/.test(s)){ bullets.push(s.replace(/^[-‚Ä¢]\s+/,"")); continue; }
    flushBullets();
    blocks.push(`<p>${s}</p>`);
  }
  flushBullets();
  return blocks.filter(Boolean).join("");
}
</script>

<script>
/* ===================== DATA (Task 1 + Task 2) ===================== */
const DATA = [
  /* ==== T√ÇCHE 1 ‚Äî Pr√©sentation personnelle ==== */
  { task:"1",
    q:"Pr√©sentez-vous bri√®vement.",
    a:`Bonjour. Je m‚Äôappelle Jean Ndahiro. J‚Äôai 34 ans et je viens du Rwanda. 
Le Rwanda est un pays d‚ÄôAfrique de l‚ÄôEst, frontalier de l‚ÄôOuganda, du Burundi, de la Tanzanie et de la R√©publique d√©mocratique du Congo. 
Le Rwanda est un pays d‚ÄôAfrique de l‚ÄôEst, connu pour ses paysages verdoyants et ses collines.

Je vis actuellement au Canada, √† Toronto. 
Je suis chercheur acad√©mique √† l‚ÄôUniversit√© York, dans le domaine des neurosciences visuelles. 
Je suis mari√© et j‚Äôai un enfant de 7 ans.

Pendant mon temps libre, j‚Äôaime √©couter la radio, apprendre de nouvelles choses et passer du temps avec ma famille. 
Je parle fran√ßais, anglais et kinyarwanda, et je continue √† am√©liorer mon fran√ßais tous les jours.`},

  /* ==== T√ÇCHE 2 ‚Äî Sc√©narios & nombreuses questions ==== */

  // 1) Films
  { task:"2",
    q:"Vous √™tes ami(e) avec un francophone et devez √©crire un article sur un film pour la revue de votre association. Demandez-lui des informations.",
    a:`- Quel est le dernier film que vous avez regard√© et aim√© ?
- Quel genre de films pr√©f√©rez-vous ? Pourquoi ?
- Y a-t-il un r√©alisateur que vous appr√©ciez particuli√®rement ?
- Pouvez-vous me parler d‚Äôun film qui vous a marqu√© r√©cemment ?
- O√π et quand avez-vous vu ce film ?
- Ce film a-t-il re√ßu des prix ou des distinctions ?
- Quels sont, selon vous, les points forts de ce film ?
- Y a-t-il une sc√®ne qui vous a particuli√®rement √©mu(e) ?
- Recommanderiez-vous ce film √† quelqu‚Äôun qui apprend le fran√ßais ? Pourquoi ?
- Ce film est-il bas√© sur une histoire vraie ou une ≈ìuvre litt√©raire ?
- Comment d√©cririez-vous la bande-son ? Est-elle marquante ?
- Ce film convient-il √† tous les √¢ges ou vise-t-il un public sp√©cifique ?`},

  // 2) Agence de voyages
  { task:"2",
    q:"Vous entrez dans une agence de voyages pour organiser des vacances. Demandez des informations.",
    a:`- Quelles sont les destinations les plus populaires en ce moment ?
- Quels circuits touristiques proposez-vous ?
- Quels sont les tarifs moyens pour un s√©jour d‚Äôune semaine ?
- Quelles activit√©s sont incluses dans vos offres ?
- Y a-t-il des r√©ductions pour les familles ou les groupes ?
- Quelle destination conseilleriez-vous pour un voyage en solo ?
- Quelle est la meilleure p√©riode pour s‚Äôy rendre ?
- Quels documents sont n√©cessaires (visa, assurance, etc.) ?
- Proposez-vous des formules tout compris ?
- Quel est le temps de vol moyen pour cette destination ?
- Avez-vous des conseils avant le d√©part ?
- Offrez-vous une assistance en cas de probl√®me pendant le voyage ?`},

  // 3) F√™te entre voisins
  { task:"2",
    q:"Vous souhaitez organiser une f√™te entre voisins. Demandez des conseils √† votre voisin(e).",
    a:`- Quel est le meilleur jour pour l‚Äôorganiser ?
- Combien de personnes devrions-nous inviter ?
- O√π vaut-il mieux la faire ?
- Quel type de repas conviendrait (buffet, barbecue, repas assis‚Ä¶) ?
- Y a-t-il des restrictions de bruit dans le quartier ?
- Faut-il pr√©voir des activit√©s ou des jeux ?
- Comment inviter les voisins (affiche, papier, WhatsApp) ?
- Proposer un th√®me, est-ce une bonne id√©e ?
- Certains voisins viennent rarement : comment les encourager ?
- Pr√©voit-on un budget commun ?
- Chacun apporte un plat, qu‚Äôen pensez-vous ?
- On termine t√¥t ou on prolonge tard dans la nuit ?`},

  // 4) Nouvel arrivant
  { task:"2",
    q:"Vous venez d‚Äôarriver en ville et souhaitez rencontrer des personnes. Posez des questions √† votre voisin(e).",
    a:`- Y a-t-il des √©v√©nements locaux o√π rencontrer du monde ?
- Quels lieux du quartier sont les plus fr√©quent√©s ?
- Existe-t-il des associations ou clubs pour nouveaux arrivants ?
- Y a-t-il des groupes WhatsApp ou Facebook du quartier ?
- Des caf√©s conviviaux √† recommander pour socialiser ?
- Est-il courant d‚Äô√©changer avec ses voisins ici ?
- Quelles activit√©s sportives ou culturelles sont accessibles √† tous ?
- Comment trouver des personnes qui partagent mes centres d‚Äôint√©r√™t ?
- Connaissez-vous des initiatives locales pour les nouveaux ?
- Des conseils pour engager la conversation ?
- Quelles p√©riodes de l‚Äôann√©e facilitent les rencontres ?
- Y a-t-il des f√™tes/√©v√©nements o√π les habitants se retrouvent ?`},

  // 5) Rythme de travail ‚Äî Canada
  { task:"2",
    q:"Vous vous renseignez sur les horaires et cong√©s au Canada pour comparer avec votre pays.",
    a:`- Quelles sont les heures de travail habituelles ?
- Les horaires sont-ils flexibles ou fixes ?
- Combien de jours de cong√© en moyenne ?
- Quels jours f√©ri√©s sont ch√¥m√©s ?
- Comment fonctionne le cong√© parental ?
- Diff√©rences public/priv√© pour les cong√©s ?
- Les heures suppl√©mentaires sont-elles r√©mun√©r√©es ?
- Travaille-t-on souvent le week-end ou en soir√©e ?
- Dur√©e l√©gale de la pause d√©jeuner ?
- Cong√©s maladie pay√©s : droits ?
- Le t√©l√©travail est-il r√©pandu ?
- Quels avantages sociaux (assurances, retraite) ?`},

  // 6) Colocation
  { task:"2",
    q:"Un ami vous propose une chambre en colocation. Posez vos questions.",
    a:`- La chambre est-elle meubl√©e ?
- Quels espaces communs partagerons-nous ?
- Y a-t-il des r√®gles √† respecter ?
- Quel est le loyer et quelles charges ?
- La chambre est-elle lumineuse et bien insonoris√©e ?
- Combien de colocataires vivent d√©j√† ici ?
- Commerces et transports √† proximit√© ?
- Peut-on inviter des amis facilement ?
- Le quartier est-il calme et s√©curis√© ?
- Est-il possible d‚Äôavoir un contrat de location formel ?`},

  // 7) Nouvel emploi ‚Äî ami(e)
  { task:"2",
    q:"Votre ami(e) a commenc√© un nouveau travail. Informez-vous sur son exp√©rience.",
    a:`- Quelles sont tes premi√®res impressions ?
- Quelles sont les principales responsabilit√©s ?
- Tu t‚Äôentends bien avec l‚Äô√©quipe ?
- Quels sont les horaires de travail ?
- Le poste est-il proche de chez toi ?
- Quels d√©fis rencontres-tu ?
- Qu‚Äôest-ce qui te pla√Æt le plus ?
- Le salaire est-il satisfaisant ?
- Des possibilit√©s d‚Äô√©volution ?
- Re√ßois-tu des formations ou du soutien ?`},

  // 8) M√©decin rempla√ßant
  { task:"2",
    q:"L‚Äôassistante de votre m√©decin vous informe qu‚Äôil est en vacances et remplac√©. Posez vos questions.",
    a:`- Quel est le nom du m√©decin rempla√ßant ?
- A-t-il les m√™mes sp√©cialit√©s que mon m√©decin ?
- Est-il possible d‚Äôavoir un rendez-vous cette semaine ?
- Peut-il acc√©der √† mon dossier m√©dical ?
- Quels sont ses horaires de consultation ?
- Comment prendre rendez-vous avec lui ?
- Est-il recommand√© pour mon cas ?
- Y a-t-il des frais suppl√©mentaires ?
- Combien de temps assurera-t-il le remplacement ?
- Puis-je le contacter en cas d‚Äôurgence ?`},

  // 9) Blog de voyage
  { task:"2",
    q:"Vous souhaitez cr√©er un blog de voyage. Demandez conseil √† votre ami(e) blogueur(euse).",
    a:`- Quel h√©bergeur recommandes-tu pour d√©marrer ?
- Quels th√®mes sont populaires actuellement ?
- Faut-il investir dans un design personnalis√© ?
- Comment attirer des lecteurs ?
- Combien de temps hebdomadaire y consacrer ?
- Quels sujets ou rubriques aborder ?
- Faut-il publier r√©guli√®rement pour fid√©liser ?
- Quels r√©seaux sociaux sont les plus efficaces ?
- Des conseils pour √©crire des articles int√©ressants ?
- Comment choisis-tu les images et visuels ?`},

  // 10) Anniversaire
  { task:"2",
    q:"Vous pr√©parez l‚Äôanniversaire de votre conjoint(e) au Canada. Demandez des id√©es √† votre voisin(e).",
    a:`- Meilleurs restaurants pour un anniversaire ?
- Lieux romantiques pour une soir√©e sp√©ciale ?
- Id√©es d‚Äôactivit√©s √† faire en couple ?
- Y a-t-il des salles ou espaces pour un petit √©v√©nement priv√© ?
- O√π acheter un bon g√¢teau ?
- Magasins pour les d√©corations ?
- Types de restaurants les plus appr√©ci√©s ici ?
- Peut-on r√©server un espace ext√©rieur ?
- Contacts de photographes ?
- Connais-tu des musiciens ou DJ pour animer ?`},

  // 11) Nouveau voisin
  { task:"2",
    q:"Vous √™tes nouveau/nouvelle dans l‚Äôimmeuble et faites connaissance dans l‚Äôascenseur.",
    a:`- Depuis combien de temps habitez-vous ici ?
- Comment est l‚Äôambiance g√©n√©rale ?
- Les voisins se connaissent-ils bien ?
- Des activit√©s organis√©es entre voisins ?
- Des recommandations sur les personnes √† conna√Ætre ?
- R√®gles sp√©cifiques (bruit, d√©chets, etc.) ?
- Les parties communes sont-elles bien entretenues ?
- Avez-vous d√©j√† eu des probl√®mes de voisinage ?
- L‚Äôimmeuble est-il calme la nuit ?
- Y a-t-il beaucoup d‚Äôenfants dans l‚Äôimmeuble ?`}
];
</script>

<script>
/* ===================== UI / RENDER ===================== */
const listEl = document.getElementById('list');
const tabsEl = document.getElementById('tabs');
const qInput = document.getElementById('q');
document.getElementById('year').textContent = new Date().getFullYear();

let CURRENT_TASK = "1";
let QUERY = "";

function itemTemplate(x){
  return `
  <article class="item">
    <header>
      <h4><strong>${x.q}</strong> <span class="badge">T√¢che ${x.task}</span></h4>
      <div class="controls">
        <button class="btn js-toggle">Voir la r√©ponse</button>
      </div>
    </header>
    <div class="q muted">${
      x.task==="3"
        ? "üìù Conseil : annoncez le but ‚Üí encha√Ænez des questions pr√©cises (prix, d√©lais, docs‚Ä¶) ‚Üí relance ‚Üí cl√¥ture polie."
        : x.task==="2"
        ? "üìù Conseil : bonjour + motif, demande claire, d√©tails (dates, r√©f√©rences), formule de politesse."
        : "üìù Conseil : intro, 2‚Äì3 id√©es avec exemples, nuance, conclusion."
    }</div>
    <div class="a" style="display:none">${formatAnswer(x.a)}</div>
  </article>`;
}

function render(){
  const items = DATA
    .filter(x => x.task === CURRENT_TASK)
    .filter(x => !QUERY || (x.q.toLowerCase().includes(QUERY) || x.a.toLowerCase().includes(QUERY)));

  if (!items.length){
    listEl.innerHTML = `<p class="meta">Aucun r√©sultat. Essayez un autre mot-cl√©.</p>`;
    return;
  }
  listEl.innerHTML = items.map(itemTemplate).join('');
  document.querySelectorAll('.js-toggle').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const ans = btn.closest('.item').querySelector('.a');
      ans.style.display = (ans.style.display !== 'none') ? 'none' : 'block';
    });
  });
}

// Expose for JSON loader
window.render = render;

// Tabs
tabsEl.querySelectorAll('.tab').forEach(b=>{
  b.addEventListener('click', ()=>{
    tabsEl.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    CURRENT_TASK = b.dataset.task;
    render();
  });
});

// Search
qInput.addEventListener('input', e=>{
  QUERY = (e.target.value||'').trim().toLowerCase();
  render();
});

// Initial render
render();

/* ===================== Load full Task 3 from JSON ===================== */
fetch('tcf_task3_full.json')
  .then(r => r.json())
  .then(items => {
    if (Array.isArray(items)) {
      DATA.push(...items.map(x => ({ task:"3", q:String(x.q||"").trim(), a:String(x.a||"").trim() })));
      if (CURRENT_TASK === "3") render();
    }
  })
  .catch(()=>{/* If JSON missing locally (file://), it will work once deployed */});
</script>
</body>
</html>
